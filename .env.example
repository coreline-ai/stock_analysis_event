# =========================================
# DEEPSTOCK Research-Only (Vercel) env example
# =========================================
# 목적:
# - 실제 매매(주문)는 절대 수행하지 않는다.
# - 시그널 수집/스코어링/LLM 판단/리포트/대시보드만 제공한다.
#
# 주의:
# - 아래 "FORBIDDEN" 섹션의 키가 실제 env에 존재하면
#   앱은 부팅 단계에서 실패하도록(강제) 구현한다.
# =========================================


# -------------------------
# Runtime
# -------------------------
NODE_ENV=development

# Public Base URL (optional, for generating links in reports)
PUBLIC_BASE_URL=http://localhost:3000


# -------------------------
# Auth / Secrets
# -------------------------
# API 보호용 토큰 (production 또는 인증 강제 모드에서 사용)
# 범용 키(기존)
API_TOKEN=CHANGE_ME_LONG_RANDOM
# 리브랜딩 키 (미설정 시 API_TOKEN 사용)
DEEPSTOCK_API_TOKEN=CHANGE_ME_LONG_RANDOM

# Local/dev에서 API 인증을 우회할지 여부 (기본: true)
# production에서는 항상 토큰 인증 강제
# 범용 키(기존)
DEV_AUTH_BYPASS=true
# 리브랜딩 키
DEEPSTOCK_DEV_AUTH_BYPASS=true

# (Optional) 비상 중단 스위치 보호용 시크릿
KILL_SWITCH_SECRET=CHANGE_ME_LONG_RANDOM


# -------------------------
# Database (REQUIRED)
# -------------------------
# Postgres connection string (Vercel Postgres/Neon 등)
DATABASE_URL=postgres://USER:PASSWORD@HOST:5432/DBNAME
# Local (docker-compose.yml uses host port 15432):
# DATABASE_URL=postgres://deepstock:deepstock@127.0.0.1:15432/deepstock


# -------------------------
# Pipeline Lock (DB-based)
# -------------------------
# DATABASE_URL 기반 lock table(pipeline_locks)을 사용한다.


# -------------------------
# LLM Provider (REQUIRED)
# -------------------------
# Provider 선택: glm | openai | gemini
LLM_PROVIDER=glm

# GLM (권장)
GLM_API_KEY=YOUR_GLM_KEY
GLM_BASE_URL=https://api.z.ai/api/coding/paas/v4
GLM_MODEL=GLM-4.6
GLM_TEMPERATURE=0
GLM_THINKING_TYPE=disabled

# OpenAI (선택)
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_TEMPERATURE=0.2

# Gemini (선택)
GEMINI_API_KEY=
GEMINI_BASE_URL=https://generativelanguage.googleapis.com/v1beta
GEMINI_MODEL=gemini-2.0-flash
GEMINI_TEMPERATURE=0.2

# 공통 모델 지정(선택): 미설정 시 provider 기본 모델 사용
LLM_MODEL=

# LLM 비용/호출 제한 (기본값 예시)
LLM_MAX_SIGNALS_PER_RUN=10
LLM_MAX_CALLS_PER_RUN=10
LLM_MAX_TOKENS_PER_CALL=1500


# -------------------------
# Pipeline Limits (RECOMMENDED)
# -------------------------
# 수집/처리량 타임박스 (서버리스 실행시간 고려)
GATHER_MAX_ITEMS_PER_SOURCE=200
SCORE_TOP_N=50
DECIDE_TOP_N=10

# 실행 간 최소 간격(초) - 중복 실행 억제 보조
MIN_SECONDS_BETWEEN_RUNS=120

# 단일 실행 타임박스 (초) - 서버리스 제한 대응
RUN_MAX_SECONDS=25
SYMBOL_RUN_MAX_SECONDS=90
SYMBOL_SCORE_TOP_N=30

# 실행 기본 스코프/전략 (US|KR|ALL)
DEFAULT_MARKET_SCOPE=KR
DEFAULT_STRATEGY_KEY=kr_default


# -------------------------
# Sources (OPTIONAL)
# -------------------------
# 기본은 공개 소스(키 없이)로 동작.
# 필요 시 소스별 키를 추가(선택)한다.

# Reddit official API (optional)
REDDIT_CLIENT_ID=
REDDIT_CLIENT_SECRET=
REDDIT_USER_AGENT=deepstock-research-only

# News API (optional)
NEWS_API_KEY=

# Korean market sources (optional)
KR_MARKET_ENABLED=true
DART_API_KEY=
NAVER_ENABLED=true
DART_ENABLED=true
DART_NEWS_FALLBACK_ENABLED=true
KR_COMMUNITY_ENABLED=true
KR_NEWS_ENABLED=true
KR_RESEARCH_ENABLED=true
KR_GLOBAL_CONTEXT_ENABLED=true

# Strategy preset overrides (optional)
US_GATHER_MAX_ITEMS_PER_SOURCE=
US_DECIDE_TOP_N=
US_LLM_MAX_SIGNALS_PER_RUN=
US_LLM_MAX_CALLS_PER_RUN=
US_LLM_MAX_TOKENS_PER_CALL=

KR_GATHER_MAX_ITEMS_PER_SOURCE=
KR_DECIDE_TOP_N=
KR_LLM_MAX_SIGNALS_PER_RUN=
KR_LLM_MAX_CALLS_PER_RUN=
KR_LLM_MAX_TOKENS_PER_CALL=
KR_RUN_MAX_SECONDS=

ALL_GATHER_MAX_ITEMS_PER_SOURCE=
ALL_DECIDE_TOP_N=
ALL_LLM_MAX_SIGNALS_PER_RUN=
ALL_LLM_MAX_CALLS_PER_RUN=
ALL_LLM_MAX_TOKENS_PER_CALL=

# Crypto signals (optional)
CRYPTO_ENABLED=false
CRYPTO_SYMBOLS=BTC,ETH,SOL

# Notification (optional)
DISCORD_WEBHOOK_URL=


# -------------------------
# FORBIDDEN (MUST NOT BE SET)
# -------------------------
# 아래 항목은 Research-Only 모드에서 존재하면 안 된다.
# 실제 env에 존재할 경우, 앱은 "부팅 실패" 처리해야 한다.

ALPACA_API_KEY=
ALPACA_API_SECRET=
BROKER_MODE=
TRADING_ENABLED=
